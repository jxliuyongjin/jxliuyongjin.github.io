<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.66">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>我的blog ！</title><meta name="description" content="这是我的blog站点~">
    <link rel="preload" href="/assets/style-3403cc01.css" as="style"><link rel="stylesheet" href="/assets/style-3403cc01.css">
    <link rel="modulepreload" href="/assets/app-05941657.js"><link rel="modulepreload" href="/assets/6、dockerfile.html-f1eca4f5.js"><link rel="modulepreload" href="/assets/6、dockerfile.html-eba51477.js"><link rel="prefetch" href="/assets/index.html-b057c833.js" as="script"><link rel="prefetch" href="/assets/360安全卫士设置.html-a8aa1c99.js" as="script"><link rel="prefetch" href="/assets/常识.html-cfc42b36.js" as="script"><link rel="prefetch" href="/assets/资源地址.html-ff0e97c2.js" as="script"><link rel="prefetch" href="/assets/linux命令.html-8187b94f.js" as="script"><link rel="prefetch" href="/assets/腾讯云服务器CentOS7安装mysql8.html-b23f640f.js" as="script"><link rel="prefetch" href="/assets/1、安装.html-d184d441.js" as="script"><link rel="prefetch" href="/assets/2、常用命令.html-b3b75a99.js" as="script"><link rel="prefetch" href="/assets/3、自定义镜像.html-072123c3.js" as="script"><link rel="prefetch" href="/assets/4、安装软件.html-a15ea009.js" as="script"><link rel="prefetch" href="/assets/5、mysql的主从复制.html-c0285bfe.js" as="script"><link rel="prefetch" href="/assets/7、docker微服务实战.html-505e1dfe.js" as="script"><link rel="prefetch" href="/assets/8、docker network.html-2ef3a333.js" as="script"><link rel="prefetch" href="/assets/9、Docker-Compose.html-f9e7fc10.js" as="script"><link rel="prefetch" href="/assets/Idea快捷键.html-a9b03a35.js" as="script"><link rel="prefetch" href="/assets/maven.html-11d63bcb.js" as="script"><link rel="prefetch" href="/assets/1、简介和安装.html-6a1f57e0.js" as="script"><link rel="prefetch" href="/assets/1.配置.html-1f413112.js" as="script"><link rel="prefetch" href="/assets/2.基础操作.html-31ae2942.js" as="script"><link rel="prefetch" href="/assets/3.构造器.html-a1d4799f.js" as="script"><link rel="prefetch" href="/assets/4.插件.html-7c8c197c.js" as="script"><link rel="prefetch" href="/assets/5.MyBatisx.html-f1d13a96.js" as="script"><link rel="prefetch" href="/assets/css基础.html-7d27fdc5.js" as="script"><link rel="prefetch" href="/assets/盒子模型.html-ff988585.js" as="script"><link rel="prefetch" href="/assets/1、基础.html-0c667f4c.js" as="script"><link rel="prefetch" href="/assets/v2.0基础.html-25cb9fd4.js" as="script"><link rel="prefetch" href="/assets/v2.0组件.html-49e9c349.js" as="script"><link rel="prefetch" href="/assets/环境搭建.html-ca9b7169.js" as="script"><link rel="prefetch" href="/assets/google chrome安装.html-e97f1c8a.js" as="script"><link rel="prefetch" href="/assets/1、基础.html-85d0846f.js" as="script"><link rel="prefetch" href="/assets/2、实战.html-b2c49e9f.js" as="script"><link rel="prefetch" href="/assets/3、xr-frame.html-7cb8bed1.js" as="script"><link rel="prefetch" href="/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/assets/index.html-66bd8016.js" as="script"><link rel="prefetch" href="/assets/360安全卫士设置.html-a3192bb4.js" as="script"><link rel="prefetch" href="/assets/常识.html-b02cde1f.js" as="script"><link rel="prefetch" href="/assets/资源地址.html-de1f8119.js" as="script"><link rel="prefetch" href="/assets/linux命令.html-56579d53.js" as="script"><link rel="prefetch" href="/assets/腾讯云服务器CentOS7安装mysql8.html-9d35522d.js" as="script"><link rel="prefetch" href="/assets/1、安装.html-248350be.js" as="script"><link rel="prefetch" href="/assets/2、常用命令.html-ef9987b0.js" as="script"><link rel="prefetch" href="/assets/3、自定义镜像.html-b1e4977b.js" as="script"><link rel="prefetch" href="/assets/4、安装软件.html-6b513e2e.js" as="script"><link rel="prefetch" href="/assets/5、mysql的主从复制.html-e8cf6039.js" as="script"><link rel="prefetch" href="/assets/7、docker微服务实战.html-00714859.js" as="script"><link rel="prefetch" href="/assets/8、docker network.html-9367e624.js" as="script"><link rel="prefetch" href="/assets/9、Docker-Compose.html-c00e3607.js" as="script"><link rel="prefetch" href="/assets/Idea快捷键.html-28cf8de5.js" as="script"><link rel="prefetch" href="/assets/maven.html-faf87d40.js" as="script"><link rel="prefetch" href="/assets/1、简介和安装.html-5e45f573.js" as="script"><link rel="prefetch" href="/assets/1.配置.html-56b0a2d4.js" as="script"><link rel="prefetch" href="/assets/2.基础操作.html-9eec8526.js" as="script"><link rel="prefetch" href="/assets/3.构造器.html-bc83c0ab.js" as="script"><link rel="prefetch" href="/assets/4.插件.html-6099802e.js" as="script"><link rel="prefetch" href="/assets/5.MyBatisx.html-f362e17a.js" as="script"><link rel="prefetch" href="/assets/css基础.html-656e3a94.js" as="script"><link rel="prefetch" href="/assets/盒子模型.html-6c16c224.js" as="script"><link rel="prefetch" href="/assets/1、基础.html-079c3e6a.js" as="script"><link rel="prefetch" href="/assets/v2.0基础.html-5e80df3b.js" as="script"><link rel="prefetch" href="/assets/v2.0组件.html-1b46027c.js" as="script"><link rel="prefetch" href="/assets/环境搭建.html-34cc3131.js" as="script"><link rel="prefetch" href="/assets/google chrome安装.html-8fa77ee3.js" as="script"><link rel="prefetch" href="/assets/1、基础.html-afd8a4ef.js" as="script"><link rel="prefetch" href="/assets/2、实战.html-175be5a5.js" as="script"><link rel="prefetch" href="/assets/3、xr-frame.html-3e913f2e.js" as="script"><link rel="prefetch" href="/assets/404.html-a9b6c9e7.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">我的blog ！</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">game <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><p tabindex="0" class="sidebar-item collapsible">game101 <span class="right arrow"></span></p><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">java <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li style=""><p tabindex="0" class="sidebar-item active collapsible">docker <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li style=""><a href="/java/docker/1、安装.md" class="sidebar-item" aria-label="1、安装"><!--[--><!--]--> 1、安装 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/docker/2、常用命令.md" class="sidebar-item" aria-label="2、常用命令"><!--[--><!--]--> 2、常用命令 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/docker/3、自定义镜像.md" class="sidebar-item" aria-label="3、自定义镜像"><!--[--><!--]--> 3、自定义镜像 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/docker/4、安装软件.md" class="sidebar-item" aria-label="4、安装软件"><!--[--><!--]--> 4、安装软件 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/docker/5、mysql的主从复制.md" class="sidebar-item" aria-label="5、mysql的主从复制"><!--[--><!--]--> 5、mysql的主从复制 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/docker/6、dockerfile.md" class="sidebar-item active" aria-label="6、dockerfile"><!--[--><!--]--> 6、dockerfile <!--[--><!--]--></a><!----></li><li style=""><a href="/java/docker/7、docker微服务实战.md" class="sidebar-item" aria-label="7、docker微服务实战"><!--[--><!--]--> 7、docker微服务实战 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/docker/8、docker network.md" class="sidebar-item" aria-label="8、docker network"><!--[--><!--]--> 8、docker network <!--[--><!--]--></a><!----></li><li style=""><a href="/java/docker/9、Docker-Compose.md" class="sidebar-item" aria-label="9、Docker-Compose"><!--[--><!--]--> 9、Docker-Compose <!--[--><!--]--></a><!----></li><!--]--></ul></li><li style=""><p tabindex="0" class="sidebar-item collapsible">idea <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/java/idea/Idea快捷键.md" class="sidebar-item" aria-label="Idea快捷键"><!--[--><!--]--> Idea快捷键 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/idea/maven.md" class="sidebar-item" aria-label="maven"><!--[--><!--]--> maven <!--[--><!--]--></a><!----></li><!--]--></ul></li><li style=""><p tabindex="0" class="sidebar-item collapsible">k8s <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/java/k8s/1、简介和安装.md" class="sidebar-item" aria-label="1、简介和安装"><!--[--><!--]--> 1、简介和安装 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li style=""><p tabindex="0" class="sidebar-item collapsible">mybatisplus <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/java/mybatisplus/1.配置.md" class="sidebar-item" aria-label="1.配置"><!--[--><!--]--> 1.配置 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/mybatisplus/2.基础操作.md" class="sidebar-item" aria-label="2.基础操作"><!--[--><!--]--> 2.基础操作 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/mybatisplus/3.构造器.md" class="sidebar-item" aria-label="3.构造器"><!--[--><!--]--> 3.构造器 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/mybatisplus/4.插件.md" class="sidebar-item" aria-label="4.插件"><!--[--><!--]--> 4.插件 <!--[--><!--]--></a><!----></li><li style=""><a href="/java/mybatisplus/5.mybatisx.md" class="sidebar-item" aria-label="5.mybatisx"><!--[--><!--]--> 5.mybatisx <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">js <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><p tabindex="0" class="sidebar-item collapsible">css3 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/js/css3/css基础.md" class="sidebar-item" aria-label="css基础"><!--[--><!--]--> css基础 <!--[--><!--]--></a><!----></li><li style=""><a href="/js/css3/盒子模型.md" class="sidebar-item" aria-label="盒子模型"><!--[--><!--]--> 盒子模型 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li style=""><p tabindex="0" class="sidebar-item collapsible">html5 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/js/html5/1、基础.md" class="sidebar-item" aria-label="1、基础"><!--[--><!--]--> 1、基础 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li style=""><p tabindex="0" class="sidebar-item collapsible">vue <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/js/vue/v2.0基础.md" class="sidebar-item" aria-label="v2.0基础"><!--[--><!--]--> v2.0基础 <!--[--><!--]--></a><!----></li><li style=""><a href="/js/vue/v2.0组件.md" class="sidebar-item" aria-label="v2.0组件"><!--[--><!--]--> v2.0组件 <!--[--><!--]--></a><!----></li><li style=""><a href="/js/vue/环境搭建.md" class="sidebar-item" aria-label="环境搭建"><!--[--><!--]--> 环境搭建 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">kivicube ar <span class="right arrow"></span></p><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">utility <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/utility/360安全卫士设置.md" class="sidebar-item" aria-label="360安全卫士设置"><!--[--><!--]--> 360安全卫士设置 <!--[--><!--]--></a><!----></li><li style=""><p tabindex="0" class="sidebar-item collapsible">google <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/utility/google/google chrome安装.md" class="sidebar-item" aria-label="google chrome安装"><!--[--><!--]--> google chrome安装 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li style=""><a href="/utility/常识.md" class="sidebar-item" aria-label="常识"><!--[--><!--]--> 常识 <!--[--><!--]--></a><!----></li><li style=""><a href="/utility/资源地址.md" class="sidebar-item" aria-label="资源地址"><!--[--><!--]--> 资源地址 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">wechat <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><p tabindex="0" class="sidebar-item collapsible">study <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/wechat/study/1、基础.md" class="sidebar-item" aria-label="1、基础"><!--[--><!--]--> 1、基础 <!--[--><!--]--></a><!----></li><li style=""><a href="/wechat/study/2、实战.md" class="sidebar-item" aria-label="2、实战"><!--[--><!--]--> 2、实战 <!--[--><!--]--></a><!----></li><li style=""><a href="/wechat/study/3、xr-frame.md" class="sidebar-item" aria-label="3、xr-frame"><!--[--><!--]--> 3、xr-frame <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">云hosts <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li style=""><a href="/云hosts/linux命令.md" class="sidebar-item" aria-label="linux命令"><!--[--><!--]--> linux命令 <!--[--><!--]--></a><!----></li><li style=""><a href="/云hosts/腾讯云服务器CentOS7安装mysql8.md" class="sidebar-item" aria-label="腾讯云服务器CentOS7安装mysql8"><!--[--><!--]--> 腾讯云服务器CentOS7安装mysql8 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><div class="anchor-right" data-v-b4a30246><div class="anchor-right-content" data-v-b4a30246><ul data-v-b4a30246><!--[--><!--[--><li class="level level-2" data-v-b4a30246>一、Docker构建过程解析</li><!--]--><!--[--><li class="level level-2" data-v-b4a30246><div class="">二、DockerFile常用的保留字指令</div><ul class="menu"><!--[--><!--[--><li class="level level-3">1、FROM</li><!--]--><!--[--><li class="level level-3">2、MIANTAINER</li><!--]--><!--[--><li class="level level-3">3、RUN</li><!--]--><!--[--><li class="level level-3">4、EXPOSE</li><!--]--><!--[--><li class="level level-3">5、WORKDIR</li><!--]--><!--[--><li class="level level-3">6、USER</li><!--]--><!--[--><li class="level level-3">7、ENV</li><!--]--><!--[--><li class="level level-3">8、VOLUME</li><!--]--><!--[--><li class="level level-3">9、ADD</li><!--]--><!--[--><li class="level level-3">10、COPY</li><!--]--><!--[--><li class="level level-3">11、CMD</li><!--]--><!--[--><li class="level level-3">12、ENTRYPOINT</li><!--]--><!--]--></ul></li><!--]--><!--[--><li class="level level-2" data-v-b4a30246><div class="">三、案例</div><ul class="menu"><!--[--><!--[--><li class="level level-3">1、编写Dockerfile文件</li><!--]--><!--[--><li class="level level-3">2、构建</li><!--]--><!--]--></ul></li><!--]--><!--]--></ul></div></div><!--[--><!--]--><div><h2 id="一、docker构建过程解析" tabindex="-1"><a class="header-anchor" href="#一、docker构建过程解析" aria-hidden="true">#</a> 一、Docker构建过程解析</h2><h4 id="_1、基础知识" tabindex="-1"><a class="header-anchor" href="#_1、基础知识" aria-hidden="true">#</a> 1、基础知识</h4><ul><li>每条保留字指令都<!---->且后面要跟随至少一个参数</li><li>指令从上到下，按顺序执行</li><li>#表示注释</li><li>每条指令都会创建一个新的镜像层并对镜像进行提交</li></ul><h4 id="_2、执行大致流程" tabindex="-1"><a class="header-anchor" href="#_2、执行大致流程" aria-hidden="true">#</a> 2、执行大致流程</h4><p>Docker 执行DockerFile的大致流程如下：</p><ol><li>docker从基础镜像进行一个容器</li><li>执行一条指令，并对容器作出修改</li><li>执行类似docker commit的操作，提交到新的镜像层</li><li>docker在基于刚提交的镜像运行一个新的容器</li><li>执行dockerfile中的下一条指令，直到所有指令都执行完成</li></ol><h2 id="二、dockerfile常用的保留字指令" tabindex="-1"><a class="header-anchor" href="#二、dockerfile常用的保留字指令" aria-hidden="true">#</a> 二、DockerFile常用的保留字指令</h2><h3 id="_1、from" tabindex="-1"><a class="header-anchor" href="#_1、from" aria-hidden="true">#</a> 1、FROM</h3><p>说明：基础镜像，当前镜像是基于哪一个镜像为基础的，指定一个已经存在的模板，一般出现在的第一行。</p><h3 id="_2、miantainer" tabindex="-1"><a class="header-anchor" href="#_2、miantainer" aria-hidden="true">#</a> 2、MIANTAINER</h3><p>说明：镜像维护者的姓名和邮箱地址，等同于在终端执行的shell命令</p><h3 id="_3、run" tabindex="-1"><a class="header-anchor" href="#_3、run" aria-hidden="true">#</a> 3、RUN</h3><p>说明：容器构建时需要运行的命令，即RUN是在docker build时运行，比如之前在容器里添加vim命令</p><div class="language-linxu line-numbers-mode" data-ext="linxu"><pre class="language-linxu"><code>RUN yun -y install vim
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>两种格式</p><ul><li><h5 id="shell格式" tabindex="-1"><a class="header-anchor" href="#shell格式" aria-hidden="true">#</a> shell格式</h5></li></ul><p>RUN [&quot;可执行文件&quot;, “参数”, &quot;参数2”]</p><div class="language-linux line-numbers-mode" data-ext="linux"><pre class="language-linux"><code>例如：
RUN [&quot;./test.php&quot;, &quot;dev&quot;, &quot;offline&quot;]等价于 ./test.php dev offline
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><h5 id="exec格式" tabindex="-1"><a class="header-anchor" href="#exec格式" aria-hidden="true">#</a> exec格式</h5></li></ul><p>RUN [&quot;可执行文件&quot;，“参数1”，“参数2”]</p><h3 id="_4、expose" tabindex="-1"><a class="header-anchor" href="#_4、expose" aria-hidden="true">#</a> 4、EXPOSE</h3><p>说明：当前容器对外暴露出来的端口</p><h3 id="_5、workdir" tabindex="-1"><a class="header-anchor" href="#_5、workdir" aria-hidden="true">#</a> 5、WORKDIR</h3><p>说明：指定创建容器后，终端默认登录的目录，落脚点。即进入容器后所在的目录。</p><h3 id="_6、user" tabindex="-1"><a class="header-anchor" href="#_6、user" aria-hidden="true">#</a> 6、USER</h3><p>说明：指定镜像以什么样的用户去执行，默认是root</p><h3 id="_7、env" tabindex="-1"><a class="header-anchor" href="#_7、env" aria-hidden="true">#</a> 7、ENV</h3><p>说明:指定构建镜像过程中设置环境变量，类似声明一个变量</p><p>例：</p><div class="language-linux line-numbers-mode" data-ext="linux"><pre class="language-linux"><code>ENV CATALINA_HOME /usr/local/tomcat
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>即后面可以用CATALINA_HOME代替目录/usr/local/tomcat使用</p><h3 id="_8、volume" tabindex="-1"><a class="header-anchor" href="#_8、volume" aria-hidden="true">#</a> 8、VOLUME</h3><p>说明：容器数据卷，用于数据保存和持久化工作，相当与-v</p><h3 id="_9、add" tabindex="-1"><a class="header-anchor" href="#_9、add" aria-hidden="true">#</a> 9、ADD</h3><p>说明：把宿主机目录下的文件拷贝到镜像中去，而且会自动处理url和解压tar压缩包</p><h3 id="_10、copy" tabindex="-1"><a class="header-anchor" href="#_10、copy" aria-hidden="true">#</a> 10、COPY</h3><p>说明：把宿主机目录下的文件拷贝到镜像中去, COPY src dest</p><h3 id="_11、cmd" tabindex="-1"><a class="header-anchor" href="#_11、cmd" aria-hidden="true">#</a> 11、CMD</h3><p>说明：容器启动命令，指定容器启动后需要干的事情</p><p>和run相似也是两种格式：</p><ul><li>shell 格式：CMD &lt;命令&gt;</li><li>exec 格式：CMD[&quot;可执行文件&quot;，“参数1”，“参数2”]</li><li>参数列表格式：CMD [&quot;参数1&quot;，“参数2” ...]，在指定了ENTRYPOINT指令后，可以用CMD指定具体的参数。</li></ul><p>注意：</p><p>dockerfile中可以有多个CMD指令，但只有最后一个生效，CMD会被docker run之后的参数替换</p><p>例如：</p><p>tomcat中有CMD [&quot;catalina.sh&quot;, &quot;run&quot;]这么一个指令，</p><ul><li>当我们执行指令 docker run -it p 8080:8080 t1，这个时候tomcat可以启动，并执行了Catalina.start</li><li>当我们执行指令 docker run -it p 8080:8080 t1 /bin/bash,这条指令在dockerfile里添加了CMD][&quot;/bin/bash&quot;,&quot;run&quot;]，覆盖了CMD [&quot;catalina.sh&quot;, &quot;run&quot;]，所有catalina.sh不会执行，tomcat并没有被启动</li></ul><p><strong>和RUN的区别</strong></p><p><strong>CMD是在docker run时运行，RUN是在docker build时运行</strong></p><h3 id="_12、entrypoint" tabindex="-1"><a class="header-anchor" href="#_12、entrypoint" aria-hidden="true">#</a> 12、ENTRYPOINT</h3><p>介绍：也是用来指定容器启动时运行的命令，类似CMD,但是ENTERYPOINT不会被docker run 后面的命令覆盖，而且这些命令行参数会被当做参数送给ENTRYPOINT 指令指定的程序</p><p>格式：ENTRYPOINT[&quot;可执行文件&quot;，“参数1”，“参数2”]，当和CMD一起使用的时候，等于在ENTRYPOINT后面添加CMD参数，CMD就不再时一个命令了</p><p>例：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>FROM nginx

ENTRYPOINT[&quot;nginx&quot;,&quot;-c&quot;] #定参数
CMD[&quot;etc/nginx/nginx.conf&quot;] #变参
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实际运行的结果</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>//docker指令，运行nginx
docker run nginx
//实际执行的时
nginx -c etc/nginx/nginx.conf

//当然如果docker指令后自己添加了参数，则CMD里的参数就会被覆盖
docker run nginx xx.conf
//实际执行的就是
nginx -c xx.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、案例" tabindex="-1"><a class="header-anchor" href="#三、案例" aria-hidden="true">#</a> 三、案例</h2><p>目标：自定义镜像Centos7具备vim+ifconfig+jkd8</p><p>材料：jdk地址：https://www.oracle.com/java/technologies/downloads/#java8。选择</p><table><thead><tr><th>x64 Compressed Archive</th><th>132.82 MB</th><th><a href="https://www.oracle.com/java/technologies/downloads/#license-lightbox" target="_blank" rel="noopener noreferrer">jdk-8u381-linux-x64.tar.gz<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></th></tr></thead></table><p>这一款</p><h3 id="_1、编写dockerfile文件" tabindex="-1"><a class="header-anchor" href="#_1、编写dockerfile文件" aria-hidden="true">#</a> 1、编写Dockerfile文件</h3><h4 id="_1-1、下载jdk" tabindex="-1"><a class="header-anchor" href="#_1-1、下载jdk" aria-hidden="true">#</a> 1.1、下载jdk</h4><div class="language-linux line-numbers-mode" data-ext="linux"><pre class="language-linux"><code>wget https://download.oracle.com/otn/java/jdk/8u381-b09/8c876547113c4e4aab3c868e9e0ec572/jdk-8u381-linux-x64.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_1-2、编写dockerfile" tabindex="-1"><a class="header-anchor" href="#_1-2、编写dockerfile" aria-hidden="true">#</a> 1.2、编写Dockerfile</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>vim Dockerfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>内容如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>#####基础镜像centos
FROM centos
##维护人员邮箱
MAINTAINER 123456@qq.com
##创建常数变量
ENV MYPATH /usr/local
##设置默认进入目录
WORKDIR $MYPATH

##由于centos停止维护了，所以需要修改 centos 文件内容， 更改cencos镜像地址
RUN cd /etc/yum.repos.d/
RUN sed -i &#39;s/mirrorlist/#mirrorlist/g&#39; /etc/yum.repos.d/CentOS-*
RUN sed -i &#39;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#39; /etc/yum.repos.d/CentOS-*
RUN yum makecache
RUN yum update -y

##安装vim编辑器
RUN yum -y install vim
##安装ifconfig命令
RUN yum -y install net-tools
##安装java8及其lib库
RUN yum install glibc
RUN mkdir /usr/local/java
##ADD是相对路径jar,把下载好的jdk添加到容器中，安装包必须要和Dockerfile文件放在同一个位置
ADD jdk-8u381-linux-x64.tar.gz /usr/local/java
##配置java环境变量
ENV JAVA_HOME /usr/local/java/jdk1.8.0_381
ENV JRE_HOME $JAVA_HOME/jre
ENV CLASSPATH $JAVA_HOME/lib/dt.jar$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib:$CLASSPATH
ENV PATH $JAVA_HOME/bin:$PATH

EXPOSE 80
##CMD echo $MYPATH
##CMD echo &quot;success-----------------ok&quot;
CMD /bin/bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、构建" tabindex="-1"><a class="header-anchor" href="#_2、构建" aria-hidden="true">#</a> 2、构建</h3><p>执行命令:docker build -t 新镜像名字:TAG ./，</p><p>注意：TAG后面有个“.”别丢了</p><div class="language-linux line-numbers-mode" data-ext="linux"><pre class="language-linux"><code>docker build -t centosjava8:1.0 ./
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 522585487@qq.com">刘勇进</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-05941657.js" defer></script>
  </body>
</html>
